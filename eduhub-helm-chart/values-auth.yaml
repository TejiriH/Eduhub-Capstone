# Auth Service Configuration
serviceName: auth-service
replicaCount: 1

# Container port (what the app listens on)
container:
  port: 4000

# Service port (what Kubernetes exposes)
service:
  type: ClusterIP
  port: 4000

  # Image configuration
image:
  tag: "v1"

# Auth-specific resources
resources:
  requests:
    memory: "128Mi"
    cpu: "64m"
  limits:
    memory: "256Mi"
    cpu: "128m"

# Probes (use container.port)
livenessProbe:
  httpGet:
    path: /healthz
    port: 4000
  initialDelaySeconds: 60
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 5

readinessProbe:
  httpGet:
    path: /healthz
    port: 4000
  initialDelaySeconds: 30
  periodSeconds: 5
  timeoutSeconds: 3
  failureThreshold: 5

# External Secrets for auth service
externalSecrets:
  enabled: true
  secretStoreName: aws-parameter-store
  refreshInterval: 1h
  parameters:
    - secretKey: APP_URL
      remoteRef:
        key: /prod/eduhub/auth/APP_URL
    - secretKey: JWT_ACCESS_TOKEN_SECRET
      remoteRef:
        key: /prod/eduhub/auth/JWT_ACCESS_TOKEN_SECRET
    - secretKey: JWT_ACCESS_TOKEN_EXPIRES_IN
      remoteRef:
        key: /prod/eduhub/auth/JWT_ACCESS_TOKEN_EXPIRES_IN
    - secretKey: JWT_REFRESH_TOKEN_SECRET
      remoteRef:
        key: /prod/eduhub/auth/JWT_REFRESH_TOKEN_SECRET
    - secretKey: JWT_REFRESH_TOKEN_EXPIRES_IN
      remoteRef:
        key: /prod/eduhub/auth/JWT_REFRESH_TOKEN_EXPIRES_IN
    - secretKey: PORT
      remoteRef:
        key: /prod/eduhub/auth/PORT
    - secretKey: POSTGRES_DB
      remoteRef:
        key: /prod/eduhub/auth/POSTGRES_DB
    - secretKey: POSTGRES_HOST
      remoteRef:
        key: /prod/eduhub/auth/POSTGRES_HOST
    - secretKey: POSTGRES_PASSWORD
      remoteRef:
        key: /prod/eduhub/auth/POSTGRES_PASSWORD
    - secretKey: POSTGRES_USER
      remoteRef:
        key: /prod/eduhub/auth/POSTGRES_USER
    - secretKey: REDIS_URL
      remoteRef:
        key: /prod/eduhub/auth/REDIS_URL
    - secretKey: SMTP_USER
      remoteRef:
        key: /prod/eduhub/auth/SMTP_USER
    - secretKey: SMTP_PASSWORD
      remoteRef:
        key: /prod/eduhub/auth/SMTP_PASSWORD
    - secretKey: EMAIL_FROM
      remoteRef:
        key: /prod/eduhub/auth/EMAIL_FROM
    - secretKey: NODE_ENV
      remoteRef:
        key: /prod/eduhub/services/NODE_ENV
    - secretKey: POSTGRES_PORT
      remoteRef:
        key: /prod/eduhub/services/POSTGRES_PORT
    - secretKey: RESET_TOKEN_EXPIRES_IN_MINUTES
      remoteRef:
        key: /prod/eduhub/services/RESET_TOKEN_EXPIRES_IN_MINUTES
    - secretKey: SMTP_HOST
      remoteRef:
        key: /prod/eduhub/services/SMTP_HOST
    - secretKey: SMTP_PORT
      remoteRef:
        key: /prod/eduhub/services/SMTP_PORT