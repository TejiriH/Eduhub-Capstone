# Default values shared across all EduHub services

namespace: eduhub
environment: production

serviceName: ""
replicaCount: 2

# Image settings
image:
  registry: 559050244875.dkr.ecr.eu-west-1.amazonaws.com
  repository: eduhub
  pullPolicy: Always
  tag: "latest"

# Container configuration
container:
  port: 4000  # Port the app listens on inside the container

# Service configuration  
service:
  type: ClusterIP
  port: 4000  # Port exposed by the Service (can differ from container.port)

# Resource limits
resources:
  requests:
    memory: "256Mi"
    cpu: "250m"
  limits:
    memory: "512Mi"
    cpu: "500m"

# Autoscaling
autoscaling:
  enabled: true
  minReplicas: 1
  maxReplicas: 4
  targetCPUUtilizationPercentage: 70
  targetMemoryUtilizationPercentage: 90
  stepdownstabilizationWindowSeconds: 10   #seconds
  stepupstabilizationWindowSeconds: 0

# Pod Disruption Budget
podDisruptionBudget:
  enabled: true
  minAvailable: 1

# Rolling Update Strategy
rollingUpdate:
  maxUnavailable: 0
  maxSurge: 1

# Probes
livenessProbe:
  httpGet:
    path: /healthz
    port: 4000  # Should match container.port
  initialDelaySeconds: 60
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 5

readinessProbe:
  httpGet:
    path: /healthz
    port: 4000  # Should match container.port
  initialDelaySeconds: 30
  periodSeconds: 5
  timeoutSeconds: 3
  failureThreshold: 5

# External Secrets
externalSecrets:
  enabled: true
  secretStoreName: aws-parameter-store
  refreshInterval: 1h
  parameters: []