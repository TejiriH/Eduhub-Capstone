apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: notification-service-external-secret
  namespace: eduhub
spec:
  refreshInterval: 1h
  secretStoreRef:
    name: aws-parameter-store
    kind: SecretStore
  target:
    name: notification-service-secret
    creationPolicy: Owner
  data:
    # Server Configuration
    - secretKey: NODE_ENV
      remoteRef:
        key: /prod/eduhub/services/NODE_ENV
    
    - secretKey: PORT
      remoteRef:
        key: /prod/eduhub/notification/PORT
    
    - secretKey: SERVICE_NAME
      remoteRef:
        key: /prod/eduhub/notification/SERVICE_NAME
    
    # Redis Configuration
    - secretKey: REDIS_HOST
      remoteRef:
        key: /prod/eduhub/notification/REDIS_HOST
    
    - secretKey: REDIS_PORT
      remoteRef:
        key: /prod/eduhub/notification/REDIS_PORT
    
    - secretKey: REDIS_DB
      remoteRef:
        key: /prod/eduhub/notification/REDIS_DB
    
    # AWS Configuration
    - secretKey: AWS_REGION
      remoteRef:
        key: /prod/eduhub/notification/AWS_REGION
    
    - secretKey: AWS_SES_FROM_EMAIL
      remoteRef:
        key: /prod/eduhub/notification/AWS_SES_FROM_EMAIL
    
    # - secretKey: AWS_SNS_FROM_PHONE
    #   remoteRef:
    #     key: /prod/eduhub/notification/AWS_SNS_FROM_PHONE
    
    # Queue Configuration
    - secretKey: QUEUE_ATTEMPTS
      remoteRef:
        key: /prod/eduhub/notification/QUEUE_ATTEMPTS
    
    - secretKey: QUEUE_BACKOFF_DELAY
      remoteRef:
        key: /prod/eduhub/notification/QUEUE_BACKOFF_DELAY
    
    - secretKey: QUEUE_CLEANUP_AGE
      remoteRef:
        key: /prod/eduhub/notification/QUEUE_CLEANUP_AGE
    
    # Rate Limiting
    - secretKey: RATE_LIMIT_WINDOW_MS
      remoteRef:
        key: /prod/eduhub/notification/RATE_LIMIT_WINDOW_MS
    
    - secretKey: RATE_LIMIT_MAX_REQUESTS
      remoteRef:
        key: /prod/eduhub/notification/RATE_LIMIT_MAX_REQUESTS
    
    # Logging
    - secretKey: LOG_LEVEL
      remoteRef:
        key: /prod/eduhub/notification/LOG_LEVEL
    
    # API Configuration
    - secretKey: API_PREFIX
      remoteRef:
        key: /prod/eduhub/notification/API_PREFIX